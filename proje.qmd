---
title: "TÜRKİYE'DEKİ İKİNCİ EL ARAÇ İLANLARI ÜZERİNE VERİ ANALİZİ"
number-sections: true
code-fold: true
---

# Sunumu Görüntüle

::: slide-embed
<iframe src="https://docs.google.com/presentation/d/1K5jvzzyS4ssv9rv1J6wAxxHaMfarLY7z5Hp_dvHTf3Q/edit?usp=sharing" width="100%" height="500" frameborder="0" allowfullscreen>

</iframe>
:::

![](images/484681339013201.gif)

**Proje sayfamıza hoş geldiniz.**

*Projemizle ilgili güncellemelerden haberdar olmak için bu alanı takip edin.*

# Proje Genel Bakış ve Kapsamı

Bu çalışma, 2025 yılı Türkiye ikinci el otomobil pazarı verilerini kullanarak marka ve şehir bazlı benchmark analizi, kapsamlı keşifsel veri analizi (EDA) ve fiyat tahminlemesi (forecasting) gerçekleştirmeyi amaçlamaktadır. Kod, anlatı ve görseller Quarto ile tekrar üretilebilir biçimde hazırlanmıştır.

# Veri Seti Hakkında Bilgi

Bu projede kullanılan veri seti, Türkiye’deki popüler bir çevrimiçi araç ilan platformundan 2025 yılında web kazıma yoluyla elde edilmiş kapsamlı ikinci el otomobil ilan verilerini içermektedir \[1\]. Veri setinde farklı marka ve modellerdeki araçların; üretim yılı, kilometre bilgisi, satış fiyatı, yakıt tipi (benzin, dizel, LPG, hibrit, elektrik), vites tipi (manuel, otomatik), bulunduğu şehir (il) ve benzeri özellikleri kayıt altına alınmıştır. Toplamda on binlerce ilana ait verinin yer aldığı bu veri seti, Türkiye ikinci el otomobil piyasasının güncel durumunu yansıtacak şekilde zengin ve çeşitli bir örneklem sunmaktadır. Analiz için veri Kaggle üzerinden temin edilip (bahridgr, 2025), uygun biçimde temizlenerek R programlama diline aktarılmıştır. Veri ön işleme aşamasında eksik ya da tutarsız gözlemler elenmiş, kategorik değişkenler analiz amaçlarına uygun olarak yeniden düzenlenmiştir. Örneğin, araç yaşı üretim yılından hesaplanmış, fiyatlar gerekli durumlarda aşırı uç değerlerin etkisini azaltmak için logaritmik dönüşümle incelenmiştir.

Veri analizi ve görselleştirme işlemleri **R** dili kullanılarak ve **Quarto** ile tekrarlanabilir bir raporlama formatında yürütülmüştür \[2\]. Veri manipülasyonu ve grafik çizimleri için geniş ölçüde **tidyverse** paket ailesinden yararlanılmıştır \[3\]. Özellikle **dplyr** ve **readr** ile veri işlemleri gerçekleştirilirken, görselleştirmeler için **ggplot2** kullanılmıştır \[4\]. Coğrafi analizlerde Türkiye’nin il sınırları verisini işlemek ve harita çizimleri yapmak amacıyla **sf** paketi tercih edilmiştir \[5\]. Farklı makine öğrenmesi algoritmalarının uygulanması ve karşılaştırılması sağlanmıştır özellikle **randomForest** paketinden faydalanılmıştır \[6,7\]. Tüm bu araçlar ve yöntemler, çalışmanın şeffaf ve yeniden üretilebilir olmasını temin etmektedir.\
\
\[1\] bahridgr. (2025). *Used Car Prices in Türkiye 2025 (EN/TR)* \[Data set\]. Kaggle.\
<https://www.kaggle.com/datasets/bahridgr/used-car-prices-in-trkiye-2025-entr>

\[2\] R Core Team. (2023). *R: A language and environment for statistical computing* (Version 4.x) \[Computer software\]. R Foundation for Statistical Computing.\
<https://www.R-project.org/>

\[3\] Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D., François, R., … Yutani, H. (2019). Welcome to the **tidyverse**. *Journal of Open Source Software, 4*(43), 1686.\
<https://doi.org/10.21105/joss.01686>

\[4\] Wickham, H. (2016). *ggplot2: Elegant graphics for data analysis*. Springer.\
<https://doi.org/10.1007/978-3-319-24277-4>

\[5\] Pebesma, E. (2018). Simple features for R: Standardized support for spatial vector data. *The R Journal, 10*(1), 439–446.\
<https://doi.org/10.32614/RJ-2018-009>

\[6\] Kuhn, M. (2008). Building predictive models in R using the **caret** package. *Journal of Statistical Software, 28*(5), 1–26.\
<https://doi.org/10.18637/jss.v028.i05>

\[7\] Liaw, A., & Wiener, M. (2002). Classification and regression by **randomForest**. *R News, 2*(3), 18–22.\
<https://CRAN.R-project.org/doc/Rnews/>

## Veri Hakkında Genel Bilgiler

Veri seti CSV formatında olup yaklaşık 6.672 araç ilanına ilişkin kayıtlar ve 26 değişken barındırmaktadır. Her bir kayıt, araç ilan başlığı, il-ilçe bilgisi, fiyat, ilan tarihi, araç markası, seri ve modeli, üretim yılı, kilometre, vites tipi (manuel, otomatik vb.), yakıt türü (benzin, dizel, hibrit, elektrikli, LPG), kasa tipi (sedan, hatchback, SUV vb.), renk, motor hacmi (cc), motor gücü (HP), çekiş türü (önden, arkadan, 4x4), boya-değişen durumu, takas imkanı, satıcı türü (galeri veya bireysel), araç vergisi ve kaza geçmişi gibi kapsamlı özellikleri içermektedir. Ayrıca veri setinde, ham metin şeklindeki bazı alanların (ör. fiyat ve kilometre) temizlenmiş ve sayısal hale getirilmiş versiyonları (`Price_Clean`, `Mileage_Clean` vb.) de yer almaktadır.\
\
Veri setindeki ilan tarihlerine bakıldığında 30 Aralık 2024 ile 17 Nisan 2025 arasındaki dönemi kapsadığı görülmektedir.

## Tercih Sebebi

-Türkiye merkezli gerçek dünya verisi olması

-Araç pazarı ile ilgili güçlü içgörüler barındırması

-Fiyat tahminlemesi gibi uygulamalara uygun olması

-Zengin sayısal ve kategorik değişkenlere sahip olması sayesinde istatistiksel analiz ve görselleştirmeye uygun olması

## Veri Ön İşleme

### Kütüphanelerin Yüklenmesi

```{r output=FALSE}
library(tidyverse)     # dplyr, ggplot2, readr, tidyr, stringr, purrr, forcats
library(janitor)       # Sütun isimlerini temizleme
library(naniar)        # Eksik değer görselleştirme
library(scales)        # Etiket biçimlendirme (label_number vs.)
library(lubridate)     # Tarih işleme
library(caret)         # Modelleme ve veri bölme
library(randomForest)  # Rastgele orman modeli
library(vip)           # Değişken önem grafikleri
library(sf)            # Shapefile okuma ve coğrafi veri
library(leaflet)       # İnteraktif harita
library(TRmaps)        # Türkiye il haritası
library(stringi)       # Türkçe karakter dönüştürme için

```

### Veri Okuma ve Temizlik

```{r message=FALSE, warning=FALSE }


# Veriyi oku
cars <- read_csv("csv/Cars.csv") %>% clean_names()

# Tüm karakter sütunlarında \n, \r, \t, _x000D_ gibi ifadeleri temizle
clean_text_columns <- function(df) {
  df %>%
    mutate(across(where(is.character), ~ gsub("\\n|\\r|\\t|_x000D_", " ", .))) %>%
    mutate(across(where(is.character), ~ str_trim(.)))
}

# Temizleme fonksiyonunu uygula
cars <- clean_text_columns(cars)

# Silinecek sütunlar
drop_list <- c("listing_title", "listing_id")

# Sütunları çıkar ve tekrarlayan satırları sil
cars <- cars %>%
  select(-all_of(drop_list)) %>%
  distinct()

# Araç yaşı hesapla
cars <- cars %>%
  mutate(
    year_clean = as.numeric(year),
    age = 2025 - year_clean
  )

# car_data'nın ilk 10 satırını tablo olarak bastır
knitr::kable(head(cars, 10), caption = "Hazırlanan Veri Setinin İlk 10 Satırı")


```

### Eksik Verilerin Doldurulması

```{r output=FALSE}

# Mod hesaplama fonksiyonu
mode_impute <- function(x) {
  ux <- na.omit(x)
  ux[which.max(tabulate(match(x, ux)))]
}

# Sayısal sütunları medyanla doldur
cars <- cars %>%
  mutate(
    mileage_clean = ifelse(is.na(mileage_clean), median(mileage_clean, na.rm = TRUE), mileage_clean),
    engine_power_clean = ifelse(is.na(engine_power_clean), median(engine_power_clean, na.rm = TRUE), engine_power_clean),
    year_clean = ifelse(is.na(year_clean), median(year_clean, na.rm = TRUE), year_clean)
  )

# Kategorik sütunları mod ile doldur
categorical_cols <- c("fuel_type", "transmission_type", "seller_type", "accident_history", "color", "drive_train", "body_type")
for (col in categorical_cols) {
  cars[[col]][is.na(cars[[col]])] <- mode_impute(cars[[col]])
}

# Sayıları karakter içinden ayıkla ve sayıya çevir
cars <- cars %>%
  mutate(
    engine_power_hp = str_extract(engine_power_hp, "\\d+") %>% as.numeric(),
    engine_size_clean = str_extract(engine_size_clean, "\\d+") %>% as.numeric(),
    engine_size_cc = parse_number(as.character(engine_size_cc))
  )

# engine_power_hp ve engine_size sütunlarını marka-model bazlı doldur
cars <- cars %>%
  group_by(brand, model) %>%
  mutate(
    engine_power_hp = ifelse(is.na(engine_power_hp), round(mean(engine_power_hp, na.rm = TRUE)), engine_power_hp),
    engine_size_clean = ifelse(is.na(engine_size_clean), round(mean(engine_size_clean, na.rm = TRUE)), engine_size_clean),
    engine_size_cc = ifelse(is.na(engine_size_cc), round(mean(engine_size_cc, na.rm = TRUE)), engine_size_cc)
  ) %>%
  ungroup()

# Kalan NA’lar için genel medyanla doldurma
cars <- cars %>%
  mutate(
    engine_power_hp = ifelse(is.na(engine_power_hp), median(engine_power_hp, na.rm = TRUE), engine_power_hp),
    engine_size_clean = ifelse(is.na(engine_size_clean), median(engine_size_clean, na.rm = TRUE), engine_size_clean),
    engine_size_cc = ifelse(is.na(engine_size_cc), median(engine_size_cc, na.rm = TRUE), engine_size_cc)
  )

# Eksik year varsa marka-model ortalaması ile doldur
cars <- cars %>%
  group_by(brand, model) %>%
  mutate(year = ifelse(is.na(year), round(mean(year, na.rm = TRUE)), year)) %>%
  ungroup()

# Araç yaşını yeniden güncelle
cars <- cars %>%
  mutate(age = 2025 - year)

# Kullanılmayan sütunları kaldır
cars <- cars %>%
  select(-any_of(c("vehicle_tax_try", "trade_in_available")))

# Kritik alanlarda eksik varsa o satırları sil
cars <- cars %>%
  filter(!is.na(year), !is.na(model), !is.na(age))

# Eksik değerleri görselleştir
gg_miss_var(cars)

```

```{r output=FALSE}

cars %>%
  summarise(across(everything(), ~ sum(is.na(.)))) %>%
  pivot_longer(cols = everything(), names_to = "değişken", values_to = "eksik_sayı") %>%
  filter(eksik_sayı > 0) %>%
  arrange(desc(eksik_sayı))

```

### Eksik Verilerin Doldurulması

Veri setinde eksik gözlemler; değişken türüne ve bağlamına göre sistematik biçimde doldurulmuştur. Sayısal değişkenlerde (örneğin motor gücü, kilometre, model yılı) eksikler önce medyan değerlerle, ardından marka-model bazlı grup ortalamalarıyla tamamlanmıştır. Kategorik değişkenlerde ise eksik değerler, değişkenin en sık görülen kategorisi (mod) ile doldurulmuştur.

Ayrıca, metin içinde gömülü olan sayısal bilgiler ayrıştırılarak analiz edilebilir biçime dönüştürülmüş; yıl bilgisi eksik olan araçlar, ait oldukları marka-model gruplarının ortalama yılı ile tahmin edilmiştir. Kritik öneme sahip değişkenlerde hâlâ eksik bilgi varsa ilgili satırlar temizlenmiştir.

Bu süreçte, eksik verilerin görselleştirilmesi için **gg_miss_var()** fonksiyonu kullanılarak genel boşluk dağılımı kontrol edilmiştir.

# Analiz

Veri hazırlandıktan sonra, proje kapsamında çeşitli analiz adımları gerçekleştirilmiştir.

**Keşifsel Veri Analizi**

İlk olarak **Keşifsel Veri Analizi (EDA)** ile verinin genel özellikleri ve önemli paternleri incelenmiştir.\
EDA kapsamında aşağıdaki başlıklara odaklanılmıştır:

-   Ortalama fiyatların marka bazında dağılımı\
-   Farklı vites ve yakıt tiplerinde fiyat farklılıkları\
-   Şehirler bazında bölgesel fiyat değişimleri

Bu analizler, uygun grafikler ve tablolar ile desteklenerek görsel olarak sunulmuştur.

**Trend Analizi**

Ardından **Trend Analizi** başlığı altında zaman boyutunda fiyat değişimleri değerlendirilmiştir.\
Bu bölümde:

-   Piyasa eğilimleri\
-   Araç yaşı ile fiyat arasındaki ilişki

gibi zamanla değişen dinamikler analiz edilmiştir.

**Model Uyarlama**

Sonraki adımda **Model Uyarlama** süreci gerçekleştirilmiştir.\
Bu bölümde:

-   İkinci el araç fiyatlarını öngörmeye yönelik istatistiksel bir model kurulmuştur.\
-   Model, verideki ilişkileri **nicel olarak** ifade etmeyi ve yeni gözlemler için fiyat tahminleri üretmeyi amaçlamaktadır.

Modelde kullanılan bağımlı ve bağımsız değişkenler belirlenerek analiz süreci yapılandırılmıştır.

**Modelin Performansı**

Kurulan modelin başarı durumu, aşağıdaki ölçütlerle değerlendirilmiş ve tartışılmıştır:

-   RMSE (Root Mean Square Error)\
-   MAE (Mean Absolute Error)\
-   R² (Determinasyon Katsayısı)

Elde edilen değerler üzerinden modelin doğruluk seviyesi analiz edilmiştir.

**Sonuçlar**

Son olarak, **Sonuçlar** kısmında analiz bulguları özetlenmiş ve genel çıkarımlar sunulmuştur.\
Bu çıkarımlar doğrultusunda:

-   Fiyatları etkileyen temel faktörler belirlenmiş\
-   Bölgesel ve özellik bazlı fiyat farkları gözlemlenmiş\
-   Kurulan modelin, gerçek piyasa koşullarına yakın sonuçlar ürettiği görülmüştür

Yapılan tüm bu analizler, ikinci el araç pazarına yönelik veri temelli kararlar alınmasına katkı sunmaktadır.

## Keşifsel Veri Analizi

```{r }
cars %>%
  summarise(
    mean_price = mean(price_clean, na.rm = TRUE),
    mean_km = mean(mileage_clean, na.rm = TRUE),
    mean_hp = mean(engine_power_clean, na.rm = TRUE)
  )
```

Bu da demektir ki veri setindeki ikinci el araçların ortalama:

Fiyatı yaklaşık 787.000 TL

Kilometresi 217.000 km

Motor gücü 108 HP

### Marka Bazlı Ortalama Fiyat Dağılımı

```{r, message=FALSE, warning=FALSE}
# Marka bazlı ortalama fiyat ve ilan sayısı
brand_summary <- cars %>%
  group_by(brand) %>%
  summarise(
    mean_price = mean(price_clean, na.rm = TRUE),
    count = n()
  ) %>%
  filter(count > 30) %>%  # Çok az gözleme sahip markaları filtrele (isteğe bağlı)
  arrange(desc(mean_price))

# Görselleştirme

ggplot(brand_summary, aes(x = reorder(brand, mean_price), y = mean_price, fill = mean_price)) +
  geom_col() +
  geom_text(aes(label = paste0(format(round(mean_price, 0), big.mark = "."), " TL")),
            hjust = 1.1, color = "white", size = 3.5) +  # hjust < 1 → dışta, > 1 → içte
  coord_flip() +
  scale_fill_gradient(low = "lightblue", high = "darkblue", guide = "none") +
  scale_y_continuous(
    limits = c(0, NA),
    labels = label_number(suffix = " TL", big.mark = ".", decimal.mark = ",")
  ) +
  labs(
    title = "Markalara Göre Ortalama Araç Fiyatları",
    x = "Marka",
    y = "Ortalama Fiyat (TL)"
  ) +
  theme_minimal(base_size = 14)




```

Markalara Göre Ortalama Araç Fiyatları

Aşağıdaki grafik, Türkiye ikinci el otomobil piyasasında en çok ilana sahip markaların ortalama araç fiyatlarını göstermektedir. Görseldeki değerler, her markaya ait ilanlardaki `price_clean` sütunu temel alınarak hesaplanmış ortalama fiyatları temsil etmektedir.

Elde edilen bulgulara göre:

-   **Mercedes-Benz**, yaklaşık **2.939.797 TL** ile açık ara en yüksek ortalama fiyata sahip markadır. Bu değer, markanın premium segmentteki konumunu ve genellikle yüksek donanım seviyesine sahip araçlar sunmasını yansıtmaktadır.
-   **Audi** ve **BMW**, sırasıyla **1.668.136 TL** ve **1.637.546 TL** ortalama fiyatlarıyla Mercedes-Benz’i takip etmektedir. Bu üç marka, ikinci el piyasasında lüks segmentte yoğunlaşmış durumdadır.
-   **Honda**, **Volkswagen** ve **Toyota** gibi markalar ise orta segmentte yer almakta olup ortalama fiyatları **700.000–900.000 TL** aralığındadır.
-   **Ford**, **Hyundai**, **Peugeot**, **Opel**, **Renault** ve **Fiat** gibi markalar, görece daha uygun fiyatlı araçlar sunmakta olup ortalama fiyatları **500.000 TL’nin altına** düşmektedir. Özellikle **Fiat**, yaklaşık **445.937 TL** ile listedeki en düşük ortalama fiyata sahip markadır.

Bu sonuçlar, markaların konumlandığı pazar segmentlerini açıkça ortaya koymaktadır. Lüks markaların ikinci el piyasada da değerini koruduğu; buna karşın ekonomik markaların daha geniş kitlelerce erişilebilir fiyatlar sunduğu görülmektedir. Ortalama fiyatlar arasındaki büyük farklar, marka algısının ve tüketici tercihlerinin ikinci el araç piyasasına doğrudan yansıdığını göstermektedir.

Sonuç olarak, araç markası ikinci el fiyatları önemli ölçüde etkiler; bu yüzden piyasa analizlerinde markaya göre değerlendirme yapmak daha doğru sonuçlar verir.

### Vites Tipine Göre Fiyat

```{r, message=FALSE, warning= FALSE }
cars %>%
  filter(!is.na(transmission_type), !is.na(price_clean), price_clean > 0) %>%
  ggplot(aes(x = transmission_type, y = log10(price_clean))) +
  geom_boxplot(fill = "lightgreen", outlier.color = "darkred", outlier.size = 1.2) +
  labs(
    title = "Vites Tipine Göre Log10(Fiyat) Dağılımı",
    x = "Vites Tipi",
    y = "log10(Fiyat) (TL)"
  ) +
  theme_minimal()
```

Vites Tipine Göre Fiyat Dağılımı<br>

Yukarıdaki kutu grafiği, ikinci el araç piyasasında vites tipine göre fiyatların logaritmik ölçekte (log10(Fiyat)) nasıl dağıldığını göstermektedir. Analiz sonuçlarına göre vites tipi, ikinci el araç fiyatlarını etkileyen önemli bir değişkendir.

**Automatic (otomatik) vitesli** araçlar, en yüksek medyan fiyata sahip grubu oluşturmaktadır. Bu durum, otomatik vitesli araçların genellikle daha yeni model ve yüksek donanımlı segmentlerde yer almasıyla ilişkilendirilebilir. Ayrıca, şehir içi kullanımda sağladığı konforun da bu fiyat farkında etkili olduğu değerlendirilmektedir.

**Manual (manuel) vitesli** araçlar, medyan fiyat açısından en düşük seviyeyi temsil etmektedir. Bu araçlar çoğunlukla daha eski veya giriş seviyesi modellerden oluşmakta olup, fiyatları da buna bağlı olarak düşmektedir.

**Semi-Automatic (yarı otomatik)** araçlar ise ortalama fiyat düzeyi bakımından iki uç arasında yer almakta; hem fiyat aralığı hem de medyan değer açısından dengeli bir görünüm sergilemektedir.

Tüm vites tiplerinde üst uçlarda çeşitli **aykırı değerler (outlier)** gözlemlenmiştir. Özellikle otomatik vitesli araç grubunda, 10⁷ TL seviyesine yaklaşan ilanlar, bu kategorinin lüks segmentteki yoğunluğunu yansıtmaktadır.

Bu bulgular, vites tipi ile ikinci el araç fiyatları arasında güçlü ve tutarlı bir ilişki olduğunu göstermektedir. Otomatik ve yarı otomatik araçlara olan yüksek talep, bu araçların daha yüksek fiyatlarla listelenmesine neden olmakta; manuel vitesli araçlar ise daha uygun fiyatlı alternatifler olarak öne çıkmaktadır.

### Ortalama Fiyat Bazında İlk 15 Şehir

```{r, message=FALSE, warning=FALSE}

library(ggplot2)
library(scales)
library(forcats)
library(RColorBrewer)

# Önce city_stats oluştur
city_stats <- cars %>%
  filter(!is.na(city), !is.na(price_clean)) %>%
  group_by(city) %>%
  summarise(
    mean_price = mean(price_clean, na.rm = TRUE),
    count = n()
  )

# Şehir bazlı ilk 15 şehri alalım (çok kalabalık olmasın)
city_top <- city_stats %>%
  filter(count >= 40) %>%
  top_n(15, mean_price)

city_colors <- RColorBrewer::brewer.pal(n = 9, name = "YlGnBu")

ggplot(city_top, aes(x = fct_reorder(city, mean_price), y = mean_price, fill = city)) +
  geom_col(width = 0.7, color = "white", show.legend = FALSE) +
  geom_text(
    aes(label = paste0(format(round(mean_price, 0), big.mark = "."), " TL")),
    hjust = 1.1, color = "white", size = 3.5
  ) +
  coord_flip() +
  scale_fill_manual(values = colorRampPalette(city_colors)(length(unique(city_top$city)))) +
  scale_y_continuous(
    limits = c(0, NA),
    labels = label_number(suffix = " TL", big.mark = ".", decimal.mark = ","),
    expand = expansion(mult = c(0, 0.05))
  ) +
  labs(
    title = "Ortalama Fiyatı En Yüksek Şehirler (İlk 15 - Min. 30 İlan)",
    x = "Şehir",
    y = "Ortalama Fiyat"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.text.y = element_text(face = "bold"),
    panel.grid.major.y = element_blank()
  )


```

### İlk 12 Şehirde Ortalama ve Medyan Fiyat Karşılaştırması

```{r, message=FALSE, warning=FALSE}

library(ggplot2)
library(scales)
library(forcats)
library(dplyr)
library(tidyr)
library(RColorBrewer)

# Ortalama ve medyan fiyatları hesapla (ilk 12 şehir)
fiyat_ozet <- cars %>%
  filter(!is.na(city), !is.na(price_clean)) %>%
  group_by(city) %>%
  filter(n() >= 40) %>%
  summarise(
    Ortalama = mean(price_clean, na.rm = TRUE),
    Medyan = median(price_clean, na.rm = TRUE),
    count = n()
  ) %>%
  arrange(desc(Ortalama)) %>%
  head(12) %>%
  pivot_longer(cols = c("Ortalama", "Medyan"), names_to = "FiyatTürü", values_to = "Fiyat") %>%
  mutate(city = fct_reorder(city, Fiyat))

# Grafik

gradient_colors <- colorRampPalette(c("#f9c5d1", "#de7fa3", "#7b2c5c"))(2)

# Grafik
ggplot(fiyat_ozet, aes(x = city, y = Fiyat, fill = FiyatTürü)) +
  geom_col(position = position_dodge(width = 0.7), width = 0.6) +
  geom_text(
    aes(label = paste0(format(round(Fiyat, 0), big.mark = "."), " TL")),
    position = position_dodge(width = 0.7),
    hjust = 1.05, size = 3.2, color = "white"
  ) +
  coord_flip() +
  scale_fill_manual(
    values = setNames(gradient_colors, c("Ortalama", "Medyan"))
  ) +
  scale_y_continuous(
    limits = c(0, NA),
    labels = label_number(suffix = " TL", big.mark = ".", decimal.mark = ","),
    expand = expansion(mult = c(0, 0.05))
  ) +
  labs(
    title = "İlk 12 Şehirde Ortalama ve Medyan Fiyat Karşılaştırması",
    x = "Şehir",
    y = "Fiyat (TL)",
    fill = "Fiyat Türü"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 14, color = "#581845"),
    axis.text.y = element_text(face = "bold"),
    legend.position = "bottom"
  )

```

Görselde ilan sayısı 40’tan fazla olan şehirler arasından ortalama fiyatı en yüksek olan ilk 12 şehir seçilerek medyan ve ortalama ikinci el araç fiyatları karşılaştırılmıştır. Görselde yer alan koyu renkli çubuklar medyan fiyatları, açık renkli çubuklar ise ortalama fiyatları temsil etmektedir.

Verilere göre:

-   **İstanbul**, yaklaşık **1.155.000 TL** ortalama ile tüm şehirler arasında açık ara en yüksek ortalama fiyata sahiptir. Medyan fiyat ise **695.000 TL**’dir. Bu iki değer arasındaki büyük fark, İstanbul’da aşırı yüksek fiyatlı ilanların bulunduğunu ve bu ilanların ortalamayı yukarı çektiğini göstermektedir.
-   **Muğla** ve **Antalya**, sırasıyla **1.028.940 TL** ve **878.882 TL** ortalama fiyatlarla İstanbul’un ardından gelmektedir. Medyan fiyatlar ise Muğla’da **760.000 TL**, Antalya’da ise **597.500 TL** düzeyindedir. Bu durum, özellikle turistik bölgelerdeki yüksek segmentli araç ilanlarının fiyat düzeyini yukarı taşıdığını ortaya koymaktadır.
-   **Diyarbakır**, **İzmir** ve **Osmaniye** gibi şehirlerde de ortalama ve medyan fiyatlar arasında dikkate değer farklar gözlenmiştir. Bu farklar, söz konusu şehirlerde bazı ilanların olağan dışı yüksek fiyatlarla listelenmiş olabileceğini düşündürmektedir.
-   Öte yandan **Gaziantep**, **Sakarya**, **Adana** ve **Mersin** gibi şehirlerde ortalama ve medyan fiyatlar birbirine daha yakın seyretmektedir. Bu durum, fiyat dağılımının daha homojen olduğunu ve aşırı uç değerlerin etkisinin sınırlı kaldığını göstermektedir.

Genel olarak, **ortalama fiyat** yüksek olsa dahi medyan değerin daha düşük kalması, veri setinde yer alan bazı ilanların aşırı fiyatlandırıldığına işaret etmektedir. Bu nedenle piyasa değerlendirmelerinde yalnızca ortalama değere odaklanmak yerine, medyan değerin de dikkate alınması daha sağlıklı bir bakış açısı sunmaktadır. Medyan değerin, veri setinin ortasındaki tipik değeri temsil etmesi açısından, ikinci el araç pazarında daha gerçekçi bir fiyat göstergesi olduğu söylenebilir.

### Türkiye’deki illerin ortalama ikinci el araç fiyatlarının harita üzerinde gösterimi

```{r, message=FALSE, warning=FALSE}

# Türkiye shapefile'ını oku
turkiye_il <- st_read("csv/tr_shp/tr.shp", quiet = TRUE)

# Türkçe karakterleri düzleştiren yardımcı fonksiyon
normalize_city <- function(x) {
  x %>%
    stri_trans_general("Latin-ASCII") %>% # Türkçe karakterleri dönüştür (İ→I, Ş→S, Ü→U)
    toupper() %>%
    trimws()
}

# Ortalama fiyatları hesapla (ilan sayısı 30'dan büyük olanlar)
fiyatlar <- cars %>%
  filter(!is.na(city), !is.na(price_clean)) %>%
  group_by(city) %>%
  summarise(
    mean_price = mean(price_clean, na.rm = TRUE),
    ilan_sayisi = n()
  ) %>%
  filter(ilan_sayisi >= 30) %>%
  mutate(city_clean = normalize_city(city))

# Harita verisini temizle
turkiye_il <- turkiye_il %>%
  mutate(city_clean = normalize_city(name))  # name yerine IL_ADI kullanıyorsan onu yaz

# Join işlemi
turkiye_il <- turkiye_il %>%
  left_join(fiyatlar, by = "city_clean")

# Harita paleti
pal <- colorNumeric(palette = "YlOrRd", domain = turkiye_il$mean_price, na.color = "gray90")

# Harita çizimi
leaflet(data = turkiye_il) %>%
  addTiles() %>%
  addPolygons(
    fillColor = ~pal(mean_price),
    weight = 1,
    opacity = 1,
    color = "white",
    dashArray = "3",
    fillOpacity = 0.7,
    label = ~paste0(name, ": ₺", format(round(mean_price), big.mark = ".", decimal.mark = ",")),
    highlightOptions = highlightOptions(
      weight = 3,
      color = "#666",
      fillOpacity = 0.9,
      bringToFront = TRUE
    )
  ) %>%
  addLegend(pal = pal, values = ~mean_price, opacity = 0.7,
            title = "Ortalama Fiyat (₺)",
            position = "bottomright")

```

### Yakıt Tipine Göre Medyan Araç Fiyatları

```{r, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)
library(scales)

# Grafik verisi
fuel_prices <- cars %>%
  group_by(fuel_type) %>%
  summarise(median_price = median(price_clean, na.rm = TRUE)) %>%
  arrange(median_price)

# Grafik
ggplot(fuel_prices, aes(x = reorder(fuel_type, median_price), y = median_price, fill = fuel_type)) +
  geom_col(width = 0.65, show.legend = FALSE) +
  geom_text(
    aes(label = paste0(format(round(median_price), big.mark = "."), " TL")),
    hjust = -0.1, size = 3.5, color = "black"
  ) +
  scale_fill_brewer(palette = "Set2") +  # Şık, pastel renk geçişleri
  coord_flip() +
  scale_y_continuous(
    limits = c(0, NA),
    labels = label_number(suffix = " TL", big.mark = ".", decimal.mark = ","),
    expand = expansion(mult = c(0, 0.2))
  ) +
  labs(
    title = "Yakıt Tipine Göre Medyan Araç Fiyatları",
    x = "Yakıt Türü",
    y = "Medyan Fiyat (TL)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 14, color = "#374151"),
    axis.text.y = element_text(face = "bold"),
    panel.grid.major.y = element_blank()
  )

```

Yakıt tipi, araçların teknolojik seviyesini ve kullanım maliyetlerini belirlemede temel bir değişkendir. Bu nedenle, ikinci el piyasasında da fiyat farklılıklarına doğrudan yansımaktadır. Çalışmada incelenen veri setinde araçlar; benzin, dizel, LPG (sadece LPG ya da LPG & benzin), hibrit ve elektrikli olmak üzere beş ana yakıt türü altında sınıflandırılmıştır.

Analiz sonuçlarına göre, yakıt türlerine göre medyan ikinci el fiyatlar şu şekilde özetlenmiştir:

-   **Elektrikli araçlar**, yaklaşık **4.190.000 TL** medyan fiyat ile en yüksek grubu oluşturmaktadır.
-   **Hibrit araçlar**, ortalama **1.270.000 TL** medyan değer ile ikinci sırada yer almaktadır.
-   **Benzinli araçlar** için bu değer yaklaşık **825.000 TL** seviyesindedir.
-   **Dizel araçlar**, yaklaşık **610.000 TL** ile benzinli araçlardan daha düşük bir ortalamaya sahiptir.
-   **LPG’li araçlar**, yaklaşık **360.000 TL** medyan fiyatla en düşük seviyedeki grubu temsil etmektedir.

Bu bulgular, farklı yakıt türlerinin ikinci el piyasada farklı kullanıcı segmentlerine hitap ettiğini ortaya koymaktadır. Elektrikli ve hibrit araçlar, yeni teknolojiye sahip ve daha pahalı segmentte konumlandıkları için daha yüksek fiyatlanmaktadır. Buna karşılık, benzinli ve dizel araçlar geniş bir model ve fiyat yelpazesine sahip olup orta düzeyde konumlanmaktadır. Dizel araçların medyan fiyatının görece düşük olması, bu araçların genellikle daha yüksek kilometreli veya ticari kullanım amaçlı tercih edilmesiyle açıklanabilir.

Önceki dönem çalışmalarıyla karşılaştırıldığında, bu sonuçlar dikkate değerdir. Örneğin **Erdem ve Şentürk (2009)**, dizel motorların ikinci el fiyatlarını artırıcı bir etkisi olduğunu belirtmişlerdir. Ancak 2025 itibarıyla teknolojik gelişmelerin benzinli motorları daha verimli hale getirmesi ve emisyon regülasyonları nedeniyle dizel araçların cazibesini yitirmeye başlaması, bu farkın yön değiştirmesine neden olmuştur.

Sonuç olarak, yakıt tipi, araç değerini etkileyen yapısal ve dinamik faktörlerle birlikte değerlendirilmesi gereken önemli bir değişkendir. İkinci el piyasa analizlerinde, fiyat tahmini veya segmentasyon çalışmalarında bu unsurun dikkate alınması daha sağlıklı öngörüler sunacaktır.

::: reference
\[8\].Erdem, C., & Şentürk, İ. (2009). *A hedonic analysis of used car prices in Turkey*. International Journal of Economic Perspectives, 3(2), 141–149.
:::

## Trend Analizi

### Araç Kilometresi ile Fiyat İlişkisi

```{r,message= FALSE, warning= FALSE }
# Bilimsel gösterimi kapat
options(scipen = 999)


library(ggplot2)
library(scales)
library(dplyr)

# Outlier'ları filtrele
q_low <- quantile(cars$mileage_clean, 0.01, na.rm = TRUE)
q_high <- quantile(cars$mileage_clean, 0.99, na.rm = TRUE)

cars_filtered <- cars %>%
  filter(
    mileage_clean >= q_low,
    mileage_clean <= q_high,
    price_clean <= quantile(price_clean, 0.99, na.rm = TRUE)
  )

# Grafik çizimi
ggplot(cars_filtered, aes(x = mileage_clean, y = price_clean)) +

  geom_point(
    aes(color = price_clean),
    alpha = 0.7,
    size = 2.2
  ) +

  geom_smooth(
    method = "lm",
    se = FALSE,
    color = "#9c0d38",
    linewidth = 1.5
  ) +

  scale_color_gradientn(
    colours = c("#ffdde1", "#faa2c1", "#f75c88", "#c9184a"),
    name = "Fiyat (TL)"
  ) +
  scale_y_continuous(
    labels = label_number(big.mark = ".", decimal.mark = ",", suffix = " TL")
  ) +
  scale_x_continuous(
    labels = label_number(big.mark = ".", decimal.mark = ",", suffix = " km")
  ) +
  labs(
    title = "Kilometre ile Fiyat Arasındaki İlişki",
    x = "Kilometre",
    y = "Fiyat (TL)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 14, color = "#9c0d38"),
    axis.text = element_text(face = "bold"),
    legend.position = "right",
    panel.grid.minor = element_blank()
  )


```

İkinci el otomobil piyasasında aracın kilometresi, değer belirleme açısından kritik bir göstergedir. Kilometre bilgisi, aracın kullanım düzeyini temsil ettiği için, piyasa değeri üzerinde doğrudan etkili olmaktadır.

Yukarıdaki grafik, araçların kilometresi ile satış fiyatı arasındaki ilişkiyi yansıtmaktadır. Gözlemler doğrultusunda şu çıkarımlar yapılabilir:

-   Genel eğilim **negatif yönlü bir korelasyonu** işaret etmektedir. Kilometre arttıkça araç fiyatlarının azaldığı gözlenmektedir.
-   Özellikle **150.000 km üzerindeki** araçlarda fiyatların büyük oranda **1.000.000 TL’nin altında** seyrettiği dikkati çekmektedir.
-   **0–50.000 km** aralığında bulunan düşük kilometreli araçlar, **3.000.000 TL ve üzeri** fiyatlara kadar ulaşabilmektedir.
-   Regresyon doğrusu, bu ilişkinin istatistiksel olarak anlamlı bir düşüş eğilimi gösterdiğini açık biçimde ortaya koymaktadır.
-   Fiyat dağılımında, **50.000–150.000 km** aralığındaki araçlar, hem fiyat hem de yoğunluk bakımından ikinci el piyasada en yaygın grubu oluşturmaktadır.

Bu bulgular, kullanım yoğunluğunun ikinci el değer üzerinde önemli bir rol oynadığını doğrulamaktadır. Aracın düşük kilometrede olması, daha az yıpranmış olma ihtimali nedeniyle alıcılar nezdinde daha yüksek bir bedelle değerlendirilmekte; buna karşılık, yüksek kilometreli araçlar daha düşük fiyatlarla alıcı bulmaktadır. Bu durum, piyasa beklentileri ve tüketici davranışları ile uyumludur.

Sonuç olarak, kilometre bilgisi, ikinci el araçların değerlemesinde dikkate alınması gereken temel değişkenlerden biri olup, fiyat tahmin modellerine dâhil edilmesi önerilmektedir.

### Araç Yaşı ve Ortalama Fiyat

```{r, message=FALSE, warning=FALSE }
# Bilimsel gösterimi tamamen kapat
options(scipen = 999)

library(ggplot2)
library(dplyr)
library(scales)

# Yaşa göre ortalama fiyat
yas_fiyat <- cars %>%
  group_by(age) %>%
  summarise(mean_price = mean(price_clean, na.rm = TRUE))

# Grafik
ggplot(yas_fiyat, aes(x = age, y = mean_price)) +
  geom_line(color = "#d11141", size = 1.3) +             # Çizgi rengi
  geom_point(color = "#333333", size = 2.5) +            # Nokta rengi
  scale_x_continuous(breaks = pretty(yas_fiyat$age)) +
  scale_y_continuous(
    labels = label_number(big.mark = ".", decimal.mark = ",", suffix = " TL")  # 1.250.000 TL
  ) +
  labs(
    title = "Araç Yaşına Göre Ortalama Fiyat",
    x = "Araç Yaşı",
    y = "Ortalama Fiyat (TL)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 14, color = "#d11141"),
    axis.text = element_text(face = "bold")
  )


```

İkinci el otomobil piyasasında araç yaşı, fiyatları etkileyen temel belirleyicilerden biridir. Aşağıdaki grafik, araç yaşının artmasıyla ortalama fiyatlarda gözle görülür bir düşüş eğilimi olduğunu ortaya koymaktadır. Bu durum, otomobil piyasasında yaygın olarak bilinen değer kaybı (*depreciation*) ilkesiyle uyum göstermektedir\[9\].

Literatürde, yeni bir aracın ilk yılında değerinin yaklaşık %15 ila %30’unu kaybettiği; izleyen her yılda ise bu kaybın ortalama %10–15 seviyelerinde gerçekleştiği belirtilmektedir\[1\] . Veri setimizde yapılan analiz de bu eğilimi desteklemektedir. Özellikle 0–2 yaş aralığındaki araçların ortalama fiyatları 3 milyon TL civarında seyrederken, 10 yaş üzeri araçlarda bu değerin belirgin biçimde azaldığı görülmüştür. Araç yaşı 20’yi geçtiğinde ise ortalama fiyatlar yüz bin TL seviyelerine kadar gerilemektedir.

Analiz bulgularına göre, araç yaşı ile ikinci el satış fiyatı arasında **negatif yönlü ve orta kuvvette bir korelasyon** bulunmaktadır (Pearson r ≈ 0.39). Bu durum, daha yeni araçların sistematik olarak daha yüksek fiyatlardan işlem gördüğünü nicel olarak teyit etmektedir.

Bununla birlikte, her model yılı için fiyat dağılımının oldukça geniş bir aralıkta olabileceği göz önünde bulundurulmalıdır. Marka, donanım seviyesi ve kilometre gibi diğer değişkenler, aynı model yılındaki iki araç arasında dahi ciddi fiyat farklılıklarına yol açabilmektedir. Örneğin, 2015 model bir lüks segment araç, 2020 model ekonomik segment bir araçtan daha yüksek fiyata sahip olabilir.

Sonuç olarak, analiz verileri, ikinci el otomobil piyasasında yaygın olarak kabul edilen “araç yaşlandıkça fiyat düşer” prensibini doğrulamaktadır. Bu bulgu, hedonik fiyatlama modelleri başta olmak üzere çeşitli değerleme yöntemlerinde yaş değişkeninin dikkate alınması gerektiğini göstermektedir\[10\].

\[9\] : Bankrate. (n.d.). *Car depreciation: What it is and how it works*. Bankrate. Erişim tarihi: 11 Mayıs 2025, <https://www.bankrate.com/insurance/car/understanding-car-depreciation/>

\[10\] : Özçalıcı, M. (2017). Predicting second-hand car sales price using decision trees and genetic algorithms. *Alphanumeric Journal, 5*(1), 103–114. <https://doi.org/10.17093/alphanumeric.323836>

## Modelin Performansı

### Model için Veri Setinin Hazırlanması

```{r}
# Temizlenmiş veri üzerinden model veri seti oluşturuluyor

car_data <- cars %>%
  filter(
    !is.na(price_clean),
    !is.na(year_clean),
    !is.na(mileage_clean),
    !is.na(engine_power_clean),
    !is.na(fuel_type),
    !is.na(transmission_type),
    !is.na(brand),
    !is.na(body_type)
  ) %>%
  mutate(
    price_log = log10(price_clean),  # log dönüşümü ile daha iyi dağılım
    across(c(fuel_type, transmission_type, brand, body_type), as.factor)
  ) %>%
  select(price_log, year_clean, mileage_clean, engine_power_clean, fuel_type, transmission_type, brand, body_type)

# car_data'nın ilk 10 satırını tablo olarak bastır
knitr::kable(head(car_data, 10), caption = "Modelleme için Hazırlanan Veri Setinin İlk 10 Satırı")

```

### Modelin Eğitilmesi ve Test Edilmesi

```{r message=FALSE, warning=FALSE}
set.seed(123)

split <- createDataPartition(car_data$price_log, p = 0.8, list = FALSE)
train_set <- car_data[split, ]
test_set <- car_data[-split, ]

rf_model <- randomForest(
  price_log ~ ., 
  data = train_set,
  ntree = 100,
  importance = TRUE
)

# Tahmin yap
predicted <- predict(rf_model, newdata = test_set)
actual <- test_set$price_log

# Performans metrikleri (log10 dönüşümlü)
rmse <- sqrt(mean((predicted - actual)^2))
mae <- mean(abs(predicted - actual))

cat("RMSE (log10):", round(rmse, 3), "\n")
cat("MAE (log10):", round(mae, 3), "\n")

# Gerçek ölçekte hata tahmini (yüzdelik)
relative_error <- (10^rmse - 1) * 100
cat("Tahmini Ortalama Hata (%):", round(relative_error, 1), "%")


```

### Tahmin Doğruluğu ve Yorum

-RMSE (log10): 0.071

-MAE (log10): 0.051

-Tahmini Ortalama Hata (%): \~17.8%

Bu sonuçlar, modelin ikinci el araç fiyatlarını oldukça başarılı şekilde tahmin ettiğini göstermektedir. Özellikle ikinci el araç piyasasındaki dalgalanma, marka ve model çeşitliliği göz önüne alındığında, bu hata oranı güçlü bir performansa işaret eder.

Model, fiyatların %80’inden fazlasını gerçek değerin ±%18’lik bir aralığında öngörebilmiştir.

### Önemli Değişkenler

```{r }
vip(rf_model, num_features = 10)

```

### Gerçek Fiyat ile Tahmin Edilen Fiyat Karşılaştırması

```{r, message=FALSE, warning=FALSE}
# Test veri seti üzerinde tahmin yap ve hata metriklerini hesapla
tahmin_df <- test_set %>%
  mutate(
    tahmin_log = predict(rf_model, newdata = .),            # Log10 tahmini
    tahmin_fiyat = 10^tahmin_log,                           # Gerçek ölçekli tahmin
    gercek_fiyat = 10^price_log,                            # Gerçek fiyat (log'dan çıkarıldı)
    hata = abs(tahmin_fiyat - gercek_fiyat),                # Mutlak hata
    hata_orani = round((hata / gercek_fiyat) * 100, 1)      # Yüzde hata
  ) %>%
  select(brand, year_clean, mileage_clean, engine_power_clean,
         fuel_type, transmission_type, body_type,
         gercek_fiyat, tahmin_fiyat, hata, hata_orani)

# En başarılı tahmin edilen 10 örneği görüntüle
  knitr::kable(head(tahmin_df %>% arrange(hata_orani), 10), caption = "En Düşük Hatalı 10 Fiyat Tahmini")


```

### En Çok Fahiş Fiyatlı İlan Bulunan Markalar ve Fahiş İlanlarda Hata Oranı Dağılımı Analizi

```{r, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)
library(viridis)

# tahmin_df ve test_set için ID ekleme
tahmin_df <- tahmin_df %>%
  mutate(id = row_number())

test_set <- test_set %>%
  mutate(id = row_number())

# Fahiş fiyatlı ilanları belirle (hata oranı > %30)
fahis_df <- tahmin_df %>%
  filter(hata_orani > 30) %>%
  select(id, hata_orani)

# Fahiş ilanların orijinal bilgilerini test_set ile birleştir
fahis_detayli <- test_set %>%
  inner_join(fahis_df, by = "id")

# cars datasından seller_type ve city gibi bilgileri ekleyelim
ilan_fahis_detay <- fahis_detayli %>%
  left_join(cars %>%
              mutate(price_log = log10(price_clean)) %>%
              select(price_log, brand, model, year_clean, mileage_clean, engine_power_clean, city, seller_type),
            by = c("price_log", "brand"))

# Marka bazlı en çok fahiş ilan (Top 10 marka)
marka_fahis <- ilan_fahis_detay %>%
  count(brand, sort = TRUE) %>%
  top_n(10, wt = n)

# Satıcı türüne göre fahiş ilan dağılımı
satici_fahis <- ilan_fahis_detay %>%
  count(seller_type, sort = TRUE)

# Şehir bazında fahiş ilan dağılımı
sehir_fahis <- ilan_fahis_detay %>%
  count(city, sort = TRUE) %>%
  top_n(10, wt = n)

ggplot(marka_fahis, aes(x = reorder(brand, n), y = n, fill = n)) +
  geom_col(width = 0.7) +
  geom_text(aes(label = n), hjust = -0.3, size = 4, fontface = "bold", color = "black") +
  coord_flip() +
  scale_fill_viridis_c(option = "D", direction = -1) +
  labs(
    title = "En Çok Fahiş Fiyatlı İlan Bulunan Markalar",
    x = "Marka",
    y = "Fahiş İlan Sayısı"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.2))) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 15, color = "#2b2b2b"),
    axis.text = element_text(face = "bold"),
    legend.position = "none"
  )

```

En Çok Fahiş Fiyatlı İlan Bulunan Markalar grafiği, ikinci el araç piyasasında tahmin edilen piyasa değerine kıyasla %30’dan fazla sapma gösteren (yani fahiş fiyatlı olarak nitelendirilebilecek) ilanların, marka bazında dağılımını göstermektedir.

Analiz sonucuna göre, Renault markası en fazla fahiş fiyatlı ilanla ilk sırada yer almakta, onu Fiat ve Opel markaları takip etmektedir. Bu durum, söz konusu markaların Türkiye genelinde yaygın olarak tercih edilmesi ve ikinci el piyasasında yüksek ilan hacmine sahip olmalarıyla ilişkilendirilebilir. Ayrıca, bazı kullanıcıların bu markalara yönelik talep avantajını fırsata çevirmeye çalışarak, piyasa değerinin üzerinde fiyatlandırmalar yaptığı değerlendirilmektedir.

Peugeot, Hyundai ve BMW gibi diğer markalar da fahiş fiyatlı ilanlar açısından dikkat çekmekle birlikte, premium segmentte yer alan Mercedes-Benz ve Audi gibi markalar, daha düşük sayıda fahiş fiyatlı ilanla listenin son sıralarında yer almıştır. Bu durum, yüksek segment araçlarda fiyat algısının daha dengeli oluştuğunu ve piyasa değerinden sapmaların nispeten daha az yaşandığını göstermektedir.

Sonuç olarak, elde edilen bulgular, ikinci el araç piyasasında bazı markalarda piyasa değerinin üzerinde fiyatlandırmaların yoğunlaştığını ortaya koymakta ve bu durumun marka bazında farklılık gösterdiğine işaret etmektedir.

```{r, message=FALSE, warning=FALSE}
ggplot(ilan_fahis_detay, aes(x = hata_orani)) +
  geom_histogram(fill = "#ff6f61", bins = 30, color = "white") +
  labs(
    title = "Fahiş Fiyatlı İlanlarda Hata Oranı Dağılımı",
    x = "Tahmin Hatası (%)",
    y = "İlan Sayısı"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 15, color = "#2b2b2b"),
    axis.text = element_text(face = "bold")
  )

```

Fahiş İlanlarda Hata Oranı Dağılımı

%30–50 aralığında hata oranına sahip ilanlar en yoğun grubu oluşturmaktadır. Bu durum, piyasadaki fahiş fiyatlı ilanların büyük çoğunluğunun, piyasa değerine kıyasla %30 ila %50 daha yüksek fiyatlandırıldığını göstermektedir.

Özellikle %35 civarındaki hata oranı, en fazla ilan sayısının gözlendiği bölgeyi temsil etmektedir.

%70 ve üzeri hata oranına sahip ilanlar, çok daha düşük sıklıkta görülmekte olup uç değerleri temsil etmektedir.

%100’ün üzerinde hata oranına sahip az sayıda ilan bulunması, bazı ilanların gerçek piyasa değerinin iki katına varan fiyatlarla listelendiğini ortaya koymaktadır.

### Satıcı Türüne Göre Fahiş Fiyat Eğilimi

```{r, message=FALSE, warning=FALSE}

library(ggplot2)
library(dplyr)
library(scales)
library(tidyr)

# Her satıcı tipi için fahiş ilan sayısı
fahis_oran_df <- ilan_fahis_detay %>%
  count(seller_type, name = "fahis") %>%
  right_join(
    cars %>% count(seller_type, name = "toplam"),
    by = "seller_type"
  ) %>%
  replace_na(list(fahis = 0)) %>%
  mutate(
    oran = round((fahis / toplam) * 100, 1),                     # Oranı hesapla
    label = paste0(seller_type, ": ", oran, "%")                 # Etiket oluştur
  ) %>%
  filter(!is.na(seller_type) & oran > 0)                         # Yalnızca oranı > 0 olanlar

# Donut grafik çizimi
ggplot(fahis_oran_df, aes(x = 2, y = oran, fill = seller_type)) +
  geom_col(width = 1, color = "white", size = 1.2) +
  coord_polar(theta = "y") +
  xlim(0.5, 2.5) +  # Donut efekti için
  geom_text(
    aes(label = label),
    position = position_stack(vjust = 0.5),
    size = 4.5,
    fontface = "bold",
    color = "black"
  ) +
  scale_fill_brewer(palette = "Set3") +
  labs(
    title = "Satıcı Tipine Göre Fahiş Fiyatlı İlan Oranı",
    fill = "Satıcı Tipi"
  ) +
  theme_void(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    legend.position = "none"
  )





```

Bu grafik, ikinci el araç ilanlarında **tahmin edilen piyasa değerine göre %30’dan fazla fiyat farkı** içeren ilanların satıcı türlerine göre dağılımını göstermektedir.

**En yüksek oran %21.3 ile Private Seller (Bireysel Satıcılar)** kategorisine aittir. Bu durum, bireysel satıcıların piyasa fiyatının üzerinde fiyat belirlemeye daha yatkın olduklarını göstermektedir. Muhtemelen piyasa bilgisine profesyonel satıcılar kadar hâkim olmamaları veya duygusal fiyatlandırma yapmaları bu sonucu doğurmuş olabilir.

**İkinci sırada %11.3 ile “Dealer” (Galerici)** tipi yer alır. Bu oran, galerilerin de belli ölçüde fahiş fiyatlı ilanlar yayınladığını ortaya koyar. Ancak yine de bireysel satıcılara kıyasla bu oran daha düşüktür.

**Authorized Dealer (Yetkili Satıcı)** ilanlarında fahiş fiyat oranı %0 çıkmıştır. Bu grup genellikle kurumsal yapıda olup fiyatlama stratejileri daha gerçekçi ve modele uygun olduğu için, tahmin edilen değerle yakınlık göstermektedir.

**Unknown** kategorisinde de oran sıfırdır; bu satıcı tipi çok az sayıda ilana sahiptir ya da veride eksik bilgi mevcuttur.

# Sonuçlar ve Ana Çıkarımlar

Bu proje kapsamında gerçekleştirilen analizler, **Türkiye’deki ikinci el otomobil piyasasının** veriye dayalı kapsamlı bir fotoğrafını sunmuştur. Keşifsel veri analizi aşaması, **marka, yakıt türü, vites tipi, bölge** gibi etmenlerin ikinci el fiyatlar üzerinde belirgin etkileri olduğunu nicel bulgularla ortaya koymuştur. Örneğin, lüks segment bir markanın aracının, ekonomik segment bir aracın onlarca katına varan fiyatlara ulaşabildiği; otomatik vites, hibrit/elektrik gibi özelliklerin yüksek fiyat segmentinde yoğunlaştığı gösterilmiştir.

**Fiyat Belirleyicileri**: İkinci el araç fiyatlarını etkileyen başlıca unsurlar; araç markası, yaşı, motor gücü, kilometre bilgisi, yakıt ve vites tipi olarak belirlenmiştir. Bu değişkenlerin fiyat üzerindeki etkileri hem keşifsel analizlerle hem de regresyon modeli aracılığıyla doğrulanmıştır.

**Bölgesel Farklılıklar**: Türkiye genelinde iller arasında ikinci el araç fiyatlarında kayda değer farklılıklar gözlemlenmiştir. İstanbul, Muğla ve Antalya gibi illerde hem medyan hem de ortalama fiyatlar oldukça yüksek seviyelerde seyrederken; İç Anadolu ve Karadeniz’in bazı illerinde fiyatlar görece daha düşüktür. Turistik talep, demografik yapı ve alım gücü bu farklılıkları şekillendiren başlıca faktörlerdir.

**Fahiş Fiyatlı İlanlar**: Tahmin edilen piyasa değerinin %30 ve üzerinde fiyat farkı içeren ilanlar "fahiş fiyatlı" olarak değerlendirilmiş ve bu kapsama giren ilanların marka, satıcı türü ve şehir dağılımları incelenmiştir. Özellikle Renault, Fiat ve Opel gibi yaygın markalarda bu tür fiyatlamalara daha sık rastlanmıştır.

**Trend analizleri** ile yıllar içindeki fiyat değişimleri ve araç yaşının getirdiği değer kaybı somut şekilde görülmüş; bunun yanında Türkiye’ye özgü piyasa hareketleri (örneğin yüksek enflasyon döneminde ikinci el araçların değer kazanması) tespit edilmiştir. Tüm bu analizlerden elde edilen içgörüler bir araya getirildiğinde, ikinci el otomobil piyasasında fiyat dinamiklerinin büyük ölçüde rasyonel ve öngörülebilir faktörlere dayandığı sonucuna varılabilir.

**Satıcı Tipi Analizi**: Fahiş fiyatlı ilanların satıcı bazlı dağılımı incelendiğinde, bireysel (private) satıcıların bu kategoride en yüksek orana sahip olduğu tespit edilmiştir (%21,3). Yetkili satıcılarda (authorized dealer) ise fahiş fiyat oranı gözlemlenmemiştir. Bu durum, fiyatlandırma sürecinde kurumsal yapının disiplin ve piyasa bilgisine dayalı kararlar alma eğilimini yansıtmaktadır.

**Modelleme Performansı**: Random Forest algoritması kullanılarak geliştirilen fiyat tahmin modeli, test verisi üzerinde yaklaşık %17,8 oranında bir ortalama hata ile yüksek doğrulukta tahminler üretmiştir. Bu sonuç, ikinci el araç fiyatlarının öngörülebilir yapıda olduğunu ve veri madenciliği yöntemleriyle başarılı biçimde modellenebileceğini göstermektedir.

**Politika ve Uygulama Önerileri**: Elde edilen model, online ilan platformlarında dinamik fiyat öneri sistemleri geliştirmek ve kullanıcıları gerçekçi fiyatlandırma konusunda yönlendirmek amacıyla entegre edilebilir. Ayrıca tüketicilerin, özellikle fahiş fiyatlı ilanlardan korunması adına medyan ve tahmin değerlerine dayalı filtreleme sistemleri oluşturulabilir.

**Türkiye bağlamında**, elde edilen bulgular piyasanın mevcut durumunu anlamamıza yardımcı olmasının yanı sıra, son yıllardaki olağanüstü koşulların etkisini de vurgulamaktadır. Yüksek enflasyon ve kur dalgalanmaları gibi makro değişkenler, ikinci el otomobil fiyatlarını alışılmadık biçimde etkilemiştir. Bu çalışma, bu etkinin veriyle izlenebileceğini ve gerektiğinde model tahminlerine yedirilebileceğini göstermiştir. İleride benzer bir analiz, örneğin yıllık bazda tekrarlandığında, fiyat trendlerindeki değişimleri (enflasyonun durulması halinde ikinci el fiyatların normal amortisman eğrisine dönüp dönmediği gibi) ortaya koyabilecektir. Dolayısıyla, çalışmamız bir **temel hat** oluşturmakta; bundan sonra piyasada meydana gelebilecek değişimleri gözlemlemek için de bir referans noktası sağlamaktadır.

Sonuç olarak, **Türkiye’deki İkinci El Araç İlanları Üzerine Veri Analizi** başlıklı bu çalışma, hem kapsamlı bir keşifsel analiz hem de başarılı bir öngörü modeli ortaya koymuştur. Çalışma bulguları, ekonomik teori ile piyasa gerçeklerinin kesiştiği noktaları netleştirmektedir. Araç değerini belirleyen temel unsurlar, Türkiye piyasasının verileriyle doğrulanmış; ayrıca piyasaya özgü anomali ve eğilimler saptanmıştır. Elde edilen içgörüler, ikinci el araç alım-satımında daha şeffaf ve bilinçli kararlar alınmasına katkı sunabilir. Son olarak, bu projenin **Quarto ile tekrarlanabilir** bir rapor formatında sunulması, benzer verilerin güncellenerek analizlerin yinelenmesine imkân tanımaktadır. Bu da, gelecekte ortaya çıkabilecek yeni trendlerin ve değişimlerin kolaylıkla izlenebileceği anlamına gelir. Böylece, veri bilimi yöntemiyle sürekli güncellenen bir **ikinci el araç piyasa barometresi** oluşturmak mümkün olabilecektir

Not: Bu raporun hazırlanması sürecinde, metnin oluşturulmasında ve dil kontrolünde OpenAI tarafından geliştirilen ChatGPT aracından faydalanılmıştır. Üretilen içerik ekip üyelerince dikkatlice incelenmiş, gerekli düzeltmeler yapılmış ve akademik etik ilkelerine uygunluk sağlanmıştır. Bu yapay zekâ kullanımına dair şeffaflık, projenin etik duruşunun bir parçası olarak burada beyan edilmektedir.
